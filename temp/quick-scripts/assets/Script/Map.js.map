{"version":3,"sources":["Map.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../assets/Script","sourcesContent":["const {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class Map extends cc.Component {\n    @property([cc.Prefab])\n    tiles: cc.Prefab[] = [];\n\n    @property(cc.Node)\n    ground: cc.Node = null;\n\n    @property(cc.Node)\n    initLand: cc.Node = null;\n\n    @property\n    gapWidth: number = 0;\n\n    @property\n    speed: number = 0;\n\n    @property\n    landHeight: number = 0;\n\n    private tilePool = new cc.NodePool();\n    private canvas: cc.Node = null;\n    private lead: cc.Node = null;\n    private leadInitY: number = null;\n    private arangItemHeight: number[] = [-40, 50, -60, 80, 0];\n    private lastItem: cc.Node = null;\n\n\n    init(canvas: cc.Node, lead: cc.Node) {\n        this.canvas = canvas;\n        this.lead = lead;\n        this.initLand.y = this.lead.y - \n            this.lead.height / 2 -\n            this.landHeight / 2; \n        this.leadInitY = this.initLand.y;\n        this.initLand.runAction(cc.repeatForever(\n            cc.moveBy(1, cc.v2(-this.speed, 0))\n            )\n        );\n    }\n\n    start() {}\n\n    lateUpdate() {\n        let firstItem = this.ground.children[0];\n        if(firstItem && firstItem.x < -1370) {\n            firstItem.stopAllActions();\n            this.tilePool.put(firstItem);\n        }\n        if(!this.lastItem || this.canvas.width > this.lastItem.x) {\n            this.renderGround(this.lastItem);\n        }\n    }\n\n    renderGround(lastItem: cc.Node) {\n        let node: cc.Node = null;\n        if(this.tilePool.size() > 0) {\n            node = this.tilePool.get();\n        }else {\n            node = cc.instantiate(\n                this.tiles[Math.floor(\n                    Math.random() * this.tiles.length\n                    )]\n                );\n        }\n        node.setParent(this.ground);\n        node.x = lastItem ? \n                    lastItem.x + \n                    lastItem.width / 2 + \n                    node.width / 2 + \n                    this.gapWidth \n                    :\n                    this.initLand.width / 2 +\n                    node.width / 2 +\n                    this.gapWidth\n                    ;\n        node.y = this.leadInitY + \n            this.arangItemHeight[Math.floor(Math.random() * this.arangItemHeight.length)];\n        this.lastItem = node;\n        node.runAction(cc.repeatForever(\n            cc.moveBy(1, cc.v2(-this.speed, 0))\n            )\n        );\n    }\n\n    createItem() {\n        let tile: cc.Prefab = null;\n        tile = this.tiles[Math.floor(Math.random() * this.tiles.length)];\n        return cc.instantiate(tile);\n    }\n}\n"]}